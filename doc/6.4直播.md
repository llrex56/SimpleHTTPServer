# ç›´æ’­ç”µå•†

## ç³»ç»Ÿç”¨ä¾‹

```plantuml

left to right direction


actor "æ¾³è§…ç”¨æˆ·" as user
actor "ç®¡ç†å‘˜" as admin
actor "ä¸»æ’­" as anchor

package "æ¾³è§…App" {
    usecase "Vä¸»æ’­æŠ¥å" as v_anchor_sign_up
    usecase "ç›´æ’­å¹¿åœº" as live_square
    usecase "å…³æ³¨ç›´æ’­é—´" as follow_live_room
    usecase "ç²‰ä¸æ‰“èµ" as fans_reward
    usecase "æ‰“èµæ¦œ" as reward_bill
    
    user --> v_anchor_sign_up
    user --> live_square
    user --> follow_live_room
    user --> fans_reward
    user --> reward_bill
}

package "æ¾³è§…åå°" {
    package "ç›´æ’­" {
        usecase "ç›´æ’­é—´ç®¡ç†" as live_room_opt
        usecase "ç²¾é€‰è”ç›Ÿ" as select_union
        usecase "æ‰“èµç¤¼ç‰©" as reward_gift
        usecase "ç›´æ’­ç®¡ç†" as live_activity_opt_manager
        usecase "è¯„è®ºç›‘æ§" as live_comment_monitor
        
        admin --> live_room_opt
        admin --> select_union
        admin --> reward_gift
        admin --> live_activity_opt_manager
        admin --> live_comment_monitor
    }
    
    package "ç›´æ’­è¿è¥" {
        usecase "Vä¸»æ’­" as v_anchor
        usecase "ç›´æ’­å¹¿åœºé…ç½®" as live_square_config
        
        admin --> v_anchor
        admin --> live_square_config
    }
    
    package "ä¸šåŠ¡é…ç½®" {
        usecase "é¢‘é“æ ç›®é…ç½®" as live_channel_config
        
        admin --> live_channel_config
    }
}

package "ç›´æ’­åå°" {
    usecase "ç›´æ’­ç®¡ç†" as live_activity_opt_live_manager
    
    anchor --> live_activity_opt_live_manager
}

package "ç§»åŠ¨ä¸»æ’­ç«¯" {
    usecase "ç›´æ’­åœºæ¬¡åˆ—è¡¨" as live_activities
    usecase "å¼€æ’­" as live_activity_publish
    
    anchor --> live_activities
    anchor --> live_activity_publish
}

```

## ç³»ç»Ÿæ´»åŠ¨å›¾

[comment]: <> (```plantuml)

[comment]: <> (start)

[comment]: <> (:åˆ›å»ºè™šæ‹Ÿå•†æˆ·;)

[comment]: <> (:å¤šç›´æ’­é—´ç®¡ç†;)

[comment]: <> (:ç›´æ’­é—´åˆ†é…ä¸»æ’­;)

[comment]: <> (if &#40;ä¸»æ’­å­˜åœ¨&#41; then &#40;æ˜¯&#41;)

[comment]: <> (    : ç»‘å®šæ—¢æœ‰ä¸»æ’­;)

[comment]: <> (else &#40;å¦&#41;)

[comment]: <> (    : åˆ›å»ºä¸»æ’­;)

[comment]: <> (    : ä¸»æ’­ç»‘å®šåŸºç¡€é—¨åº—ï¼Œåˆ†é…è´¦æˆ·;)

[comment]: <> (endif)

[comment]: <> (end)

[comment]: <> (```)

## ç³»ç»Ÿæ—¶åºå›¾

### å¤šç›´æ’­é—´
```plantuml

actor "ç®¡ç†å‘˜" as admin #red

participant "ç›´æ’­ç”µå•†" as aomi_ecommerce
participant "åŸºç¡€é—¨åº—" as aomi_base_info #lightgreen

autonumber

admin -> aomi_ecommerce : ç›´æ’­é—´ç®¡ç†
aomi_ecommerce -> aomi_base_info : ç»‘å®šé—¨åº—
aomi_base_info -> aomi_base_info : åˆ›å»ºè™šæ‹Ÿé—¨åº—ã€è´¦æˆ·
aomi_base_info -> aomi_ecommerce : store_id, account_id
aomi_ecommerce -> aomi_ecommerce : åˆ›å»ºä¸»æ’­ï¼Œç»‘å®šé—¨åº—è´¦æˆ·
aomi_ecommerce -> admin : done

====
admin -> aomi_ecommerce : å¼€å¯/å…³é—­ç›´æ’­é—´
aomi_ecommerce -> aomi_base_info : å¼€å¯/å…³åœé—¨åº—
aomi_base_info -> aomi_base_info : å¼€å¯/å…³åœè´¦æˆ·
aomi_base_info -> aomi_ecommerce : done
aomi_ecommerce -> admin : done

'====
'admin -> aomi_base_info : å•†æˆ·é—¨åº—åœç”¨
'aomi_base_info -> aomi_base_info : å…³åœè´¦æˆ·
'aomi_base_info -> aomi_ecommerce : åŒæ­¥å…³åœç›´æ’­é—´

```
- [2 ç»‘å®šé—¨åº—](http://yapi.miguatech.com/project/505/interface/api/62587)
- [8 å¼€å¯/å…³åœé—¨åº—](http://)

- [å¼€æ’­æ¨é€](https://rp.mockplus.cn/run/vr8PROw5WOMlGK/vHEeZ6xB7s2Y/-MDlIVEEd?cps=expand&rps=expand&nav=1&ha=0&la=0&fc=0&out=1&rt=1&snapshotID=Dakc1nG9XsR)
  > - ç›´æ’­é—´å¼€æ’­æ¨é€è‡³ç²‰ä¸ï¼ˆåŒé¢„å‘Šé¡µçš„å¼€æ’­æé†’ï¼‰
  > - æ¨é€æ¨™é¡Œï¼šâ€œé–‹æ’­å•¦ğŸ‰ğŸ‰â€ï¼›
  > - æ¨é€å…§å®¹ï¼šâ€œ{ç›´æ’­æ¨™é¡Œ}å·²ç¶“é–‹æ’­å•¦ï¼Œå¿«ä¾†æ¶è³¼å¿ƒå„€çš„å•†å“å§ğŸ’•â€ï¼›
  > - é»æ“Šè·³è½¬ï¼šç›´æ’­é–“ï¼›
   
- ç›´æ’­é—´å¤´åƒ
  - ç›´æ’­é—´å·¦ä¸Šè§’
    > - ç›´æ’­é—´å…ƒæ•°æ®æ¥å£ï¼Œå¡«å……logoå­—æ®µ
    > - /live-decoration/{liveActivityId}/live-room-metadata
    > - /live-decoration/{liveActivityId}/live-room-metadata-base
  - ç›´æ’­åˆ†ç±»é¡µé¢„å‘Šæ¸…å•åˆ—è¡¨
  - ç›´æ’­å¹¿åœºè§†é¢‘åŠ è½½é»˜è®¤èƒŒæ™¯
  
- ç›´æ’­é—´ç²‰ä¸åˆ—è¡¨

### ç›´æ’­å¹¿åœº
```plantuml

actor "ç”¨æˆ·" as user
actor "schedule" as job #red

participant "ç›´æ’­ç”µå•†" as aomi_ecommerce
participant "é˜¿é‡Œç›´æ’­æœåŠ¡" as ali_live #lightgreen

autonumber

job -> aomi_ecommerce : ç”Ÿæˆæ¦œå•/5min
aomi_ecommerce -> ali_live : æŸ¥è¯¢ç›´æ’­ä¿¡æ¯
ali_live -> aomi_ecommerce : done
aomi_ecommerce -> aomi_ecommerce : æ¦œå•ç®—æ³•
note right
<b>ç®—æ³•ï¼š
ç›´æ’­é–“æ’åå¾—åˆ†=ï¼ˆåœ¨ç·šäººæ•¸æ­¸ä¸€*æ¬Šé‡+ç´¯è¨ˆäººæ•¸æ­¸ä¸€*æ¬Šé‡ï¼‰+ï¼ˆ1/2^ç›´æ’­æ™‚é•·æ­¸ä¸€ï¼‰*æ¬Šé‡+å¹³å°åŠ æ¬Šæ­¸ä¸€*æ¬Šé‡ï¼›
* å…¶ä¸­åœ¨ç·šäººæ•¸/ç´¯è¨ˆäººæ•¸/ç›´æ’­æ™‚é•·æ¬Šé‡ç›¸åŠ ç‚º1ï¼Œéœ€è¦æ ¹æ“šå¡«å…¥çš„ä¿‚æ•¸è¨ˆç®—ï¼Œç®—æ³•ç‚ºï¼šæ¬Šé‡i=ä¿‚æ•¸i/ä¸‰å€‹ä¿‚æ•¸ä¹‹å’Œï¼›
* å¹³å°åŠ æ¬Šæ¬Šé‡å‰‡ç›´æ¥ç‚ºç”¨æˆ¶å¡«å…¥ï¼›
* åœ¨ç·šäººæ•¸/ç´¯è¨ˆäººæ•¸/å¹³å°åŠ æ¬Šç‚ºmaxæ­¸ä¸€æ³•ï¼Œç®—æ³•ï¼šæ­¸ä¸€i=åœ¨ç·šäººæ•¸i/åœ¨ç·šäººæ•¸æœ€å¤§å€¼ï¼›
* ç›´æ’­æ™‚é•·æ­¸ä¸€ç‚ºå·®å€¼æ­¸ä¸€æ³•ï¼Œç®—æ³•ï¼šæ­¸ä¸€i=ï¼ˆç›´æ’­æ™‚é•·i-ç›´æ’­æ™‚é•·æœ€å°å€¼ï¼‰/ï¼ˆç›´æ’­æ™‚é•·æœ€å¤§å€¼-ç›´æ’­æ™‚é•·æœ€å°å€¼ï¼‰ï¼›

<color:red>* æ‰€æœ‰æ•¸æ“šåƒ…è¨ˆç®—æœ‰é–‹æ’­çš„ç›´æ’­é–“ï¼›</color>
<color:red>* æ’åå¾—åˆ†ä¿ç•™å°æ•¸é»å¾Œ10ä½ç”¨æ–¼æ’åºï¼›</color>
<color:red>* æŒ‰æ’åå¾—åˆ†å¾é«˜åˆ°ä½æ’ï¼›</color>
<color:red>* æ¯5åˆ†é˜æœå‹™ç«¯é‡æ’ä¸€æ¬¡ï¼Œç›´æ’­ä¸­çš„ç›´æ’­é–“<=1æ™‚åœæ­¢ï¼Œ>2å¾Œé–‹å•Ÿï¼›</color>
end note
aomi_ecommerce -> job : done

==== 
user -> aomi_ecommerce : ç›´æ’­åˆ—è¡¨
note right
<b>å®¢æˆ¶ç«¯å–æ•¸ï¼š
* æ¯æ¬¡ä¸Šæ»‘æŸ¥çœ‹ä¸‹ä¸€å€‹ç›´æ’­æ™‚éœ€è¦æ ¡é©—æ˜¯å¦æœ‰æ–°çš„æ’è¡Œæ•¸æ“šï¼Œå¦‚æœæœ‰ï¼Œå‰‡å–æœ€æ–°çš„ï¼Œå¦‚æœæœ€æ–°çš„å°±æ˜¯ç•¶å‰ç›´æ’­ï¼Œå‰‡å–+1å€‹ï¼›
å¦‚æœæ²’æœ‰æœ€æ–°çš„ï¼Œå‰‡æŒ‰åŸä¾†é †åºç¹¼çºŒå–æ•¸ï¼›
* ä¸‹æ»‘è¿”å›ä¸Šä¸€å€‹ç›´æ’­æ™‚æŒ‰æ­·å²ç€è¦½è¨˜éŒ„è¿”å›ï¼Œæ­·å²è¨˜éŒ„æœ€å¤šç´€éŒ„20æ¢ï¼Œæ»‘åˆ°é ‚éƒ¨å¾Œç¹¼çºŒä¸‹æ‹‰åˆ·æ–°ï¼›
* æ‡‰ç”¨åˆ°çš„é é¢ï¼šç›´æ’­é–“ã€ç›´æ’­å»£å ´æ¨è–¦tabã€ç›´æ’­å»£å ´é—œæ³¨tabã€ç›´æ’­åˆ†é¡é ï¼ˆæŸ¥çœ‹æ›´å¤šè£¡ï¼‰ï¼›
end note
aomi_ecommerce -> user : done

```
- [[æ ¹æ®ç›´æ’­IDæ‰¹é‡æŸ¥è¯¢ç›´æ’­ä¿¡æ¯]](https://help.aliyun.com/document_detail/321833.html)
  > - åœ¨çº¿äººæ•°-OnlineCount
  > - ç´¯è®¡äººæ•°-Uv
  > - ç›´æ’­æ—¶é•¿ï¼šå½“å‰æ—¶é—´-å®é™…å¼€æ’­æ—¶é—´
  > - xxxæœ€å¤§/æœ€å°å€¼ï¼Œe.g. åœ¨çº¿äººæ•°æœ€å¤§/æœ€å°å€¼ï¼šmax(åœ¨çº¿äººæ•°)ã€min(åœ¨çº¿äººæ•°)

- å®¢æˆ·ç«¯å–æ•°
  > - åˆ†é¡µæ‹‰å–10æ¡ç›´æ’­ï¼Œæ¦œå•æœ‰æ›´æ–°ï¼Œå‘[[å¹¿æ’­æ¶ˆæ¯]](https://aomi.yuque.com/docs/share/5fc22ce7-cb83-442a-ad72-309641277f2f?#)
  > - {type: LIVE_LIST, follow: true, recommend: false}
  > - æ¦œå•æœ‰æ›´æ–°ï¼Ÿredis zsetç»´æŠ¤æ¦œå•

## æ•°æ®æ¨¡å‹

```plantuml

!define table(x) class x << (T,#ffebf3) >>
!define table(x, desc) class "desc" as x << (T,#ffebf3) x >>
!define domain(desc, x) rectangle desc as x 
'hide stereotypes
'hide field
hide methods

domain("ç›´æ’­é—´åŸŸ", live_room_domain) {

    table(live_activity, "ç›´æ’­åœºæ¬¡") {
        - åœºæ¬¡ID
        - ç›´æ’­é—´ID
    }
    table(live_activity_anchor_relation, "ç›´æ’­åœºæ¬¡ä¸»æ’­å…³è”") {
        - åœºæ¬¡ID
        - ä¸»æ’­ID
    }
    table(live_room, "ç›´æ’­é—´") {
        - ç›´æ’­é—´id
        - åç§°
        - å¤´åƒ
        - å…¬å‘Š
        - å•†æˆ·id
        - é—¨åº—id
        - çŠ¶æ€ï¼ˆä½¿ç”¨ä¸­ã€å·²å…³é—­ï¼‰
    }
    table(live_anchor, "ä¸»æ’­") {
        - ä¸»æ’­id
        - æ‰‹æœºå·
        - åç§°
        - å¤´åƒ
    }
    table(live_room_anchor_relation, "ç›´æ’­é—´ä¸»æ’­å…³è”") {
        - ç›´æ’­é—´id
        - ä¸»æ’­id
        - æ‰€å±ç±»å‹ï¼ˆç­¾çº¦è€…ã€æ‹¥æœ‰è€…ï¼‰
    }
    table(live_anchor_account, "ä¸»æ’­è´¦æˆ·") {
        - ä¸»æ’­id
        - æ¾³è§…ç”¨æˆ·id
        - æ¥æºï¼ˆVä¸»æ’­ã€å•†æˆ·ä¸»æ’­ã€å‘˜å·¥ä¸»æ’­ï¼‰
        - é—¨åº—id
        - è´¦æˆ·id
        - çŠ¶æ€ï¼ˆå¯ç”¨ã€åœç”¨ï¼‰
    }
    
    live_room "1" --> "0..*" live_room_anchor_relation: ""
    live_anchor "1" --> "0..*" live_room_anchor_relation: "" 
    live_anchor "1" --> "1" live_anchor_account: ""
    live_room "1" --> "0..*" live_activity : ""
    
    live_activity "1" --> "1" live_activity_anchor_relation : ""
    live_anchor "1" --> "0..*" live_activity_anchor_relation : ""
}

```

```plantuml

!define table(x) class x << (T,#ffebf3) >>
!define table(x, desc) class "desc" as x << (T,#ffebf3) x >>
!define domain(desc, x) rectangle desc as x 
'hide stereotypes
hide methods

domain("ç›´æ’­å¹¿åœºåŸŸ", live_room_domain) {

    table(live_column, "ç›´æ’­æ ç›®") {
        - id
        - åç§°
        - æ’åº
        - çˆ¶èŠ‚ç‚¹
    }
    table(live_square_config, "ç›´æ’­å¹¿åœºé…ç½®") {
        - id
        - æ¨èç±»å‹ï¼ˆé¦–é¡µã€æ ç›®ï¼‰
        - åœ¨çº¿äººæ•°ç³»æ•°ï¼ˆ0-100ï¼‰
        - ç´¯è®¡äººæ•°ç³»æ•°ï¼ˆ0-100ï¼‰
        - ç›´æ’­æ—¶é•¿ç³»æ•°ï¼ˆ0-100ï¼‰
        - å¹³å°åŠ æƒæƒé‡ï¼ˆ0-1ï¼‰
    }
    table(live_room_weight_config, "ç›´æ’­é—´æƒé‡é…ç½®") {
        - ç›´æ’­å¹¿åœºé…ç½®id
        - ç›´æ’­é—´id
        - æƒé‡ï¼ˆ0-100ï¼‰
    }
    table(live_room, "ç›´æ’­é—´") {
        - ç›´æ’­é—´id
    }
    table(live_activity, "ç›´æ’­æ´»åŠ¨") {
        - ç›´æ’­æ´»åŠ¨id
        - ç›´æ’­æ ç›®id
    }
    
    live_square_config "1" --> "0..*" live_room_weight_config : ""
    live_room "1" --> "1" live_room_weight_config : ""
    live_activity "0..*" <-- "1" live_column : ""
    live_room "1" --> "0..*" live_activity : ""
}

```

## æ•°æ®è„šæœ¬
```mysql

CREATE TABLE `livestream_room` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT 'ç›´æ’­é—´ID',
  `name` varchar(30) DEFAULT NULL COMMENT 'åç§°',
  `pic_url` varchar(255) DEFAULT NULL COMMENT 'å¤´åƒ',
  `notice` varchar(255) DEFAULT NULL COMMENT 'å…¬å‘Š',
  `state` enum('IN_USE','CLOSE') DEFAULT 'IN_USE' COMMENT 'ç›´æ’­é—´çŠ¶æ€',
  `bid` varchar(32) DEFAULT NULL COMMENT 'å•†æˆ·ID',
  `store_id` varchar(32) DEFAULT NULL COMMENT 'é—¨åº—ID',
  `deleted` tinyint(1) DEFAULT '0',
  `create_time` datetime(3) DEFAULT NULL,
  `update_time` datetime(3) DEFAULT NULL,
  `create_user` varchar(32) DEFAULT NULL,
  `update_user` varchar(32) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç›´æ’­é—´';

CREATE TABLE `livestream_room_fans` (
    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
    `live_room_id` bigint(20) NOT NULL COMMENT 'ç›´æ’­é—´ID',
    `user_id` varchar(32) DEFAULT NULL COMMENT 'ç”¨æˆ·ID',
    `follow` bigint(32) DEFAULT '1' COMMENT 'å…³æ³¨',
    `deleted` tinyint(1) DEFAULT '0',
    `create_time` datetime(3) DEFAULT NULL,
    `update_time` datetime(3) DEFAULT NULL,
    PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç›´æ’­é—´ç²‰ä¸';

CREATE TABLE `livestream_anchor` (
    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT 'ä¸»æ’­ID',
    `phone` varchar(20) DEFAULT NULL COMMENT 'æ‰‹æœºå·',
    `name` varchar(30) DEFAULT NULL COMMENT 'åç§°',
    `pic_url` varchar(255) DEFAULT NULL COMMENT 'å¤´åƒ',
    `deleted` tinyint(1) DEFAULT '0',
    `create_time` datetime(3) DEFAULT NULL,
    `update_time` datetime(3) DEFAULT NULL,
    `create_user` varchar(32) DEFAULT NULL,
    `update_user` varchar(32) DEFAULT NULL,
    PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ä¸»æ’­';

CREATE TABLE `livestream_anchor_account` (
     `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
     `anchor_id` bigint(20) NOT NULL COMMENT 'ä¸»æ’­ID',
     `aomi_user_id` varchar(32) DEFAULT NULL COMMENT 'æ¾³è§…ç”¨æˆ·ID',
     `source` enum('V_ANCHOR', 'MERCHANT', 'STAFF') DEFAULT NULL COMMENT 'æ¥æºï¼ˆVä¸»æ’­ã€å•†æˆ·ä¸»æ’­ã€å‘˜å·¥ä¸»æ’­ï¼‰',
     `state` enum('ENABLE', 'DISABLE') DEFAULT NULL COMMENT 'çŠ¶æ€ï¼ˆå¯ç”¨ã€åœç”¨ï¼‰',
     `store_id` varchar(32) DEFAULT NULL COMMENT 'é—¨åº—ID',
     `store_account_id` varchar(32) DEFAULT NULL COMMENT 'é—¨åº—è´¦æˆ·ID',
     `deleted` tinyint(1) DEFAULT '0',
     `create_time` datetime(3) DEFAULT NULL,
     `update_time` datetime(3) DEFAULT NULL,
     `create_user` varchar(32) DEFAULT NULL,
     `update_user` varchar(32) DEFAULT NULL,
     PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ä¸»æ’­è´¦æˆ·';

CREATE TABLE `livestream_room_anchor_relation` (
     `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
     `live_room_id` bigint(20) NOT NULL COMMENT 'ç›´æ’­é—´ID',
     `anchor_id` bigint(20) NOT NULL COMMENT 'ä¸»æ’­ID',
     `type` enum('SIGNER', 'MASTER') DEFAULT NULL COMMENT 'æ‰€å±ç±»å‹ï¼ˆç­¾çº¦è€…ã€æ‹¥æœ‰è€…ï¼‰',
     `deleted` tinyint(1) DEFAULT '0',
     `create_time` datetime(3) DEFAULT NULL,
     `update_time` datetime(3) DEFAULT NULL,
     PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç›´æ’­é—´ä¸»æ’­å…³è”';

CREATE TABLE `livestream_activity_anchor_relation` (
   `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
   `livestream_act_id` bigint(20) NOT NULL COMMENT 'ç›´æ’­åœºæ¬¡ID',
   `anchor_id` bigint(20) NOT NULL COMMENT 'ä¸»æ’­ID',
   `deleted` tinyint(1) DEFAULT '0',
   `create_time` datetime(3) DEFAULT NULL,
   `update_time` datetime(3) DEFAULT NULL,
   PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç›´æ’­åœºæ¬¡ä¸»æ’­å…³è”';



CREATE TABLE `livestream_column` (
    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
    `name` varchar(50) NOT NULL COMMENT 'åç§°',
    `seq` int DEFAULT '0' COMMENT 'æ’åº',
    `pic` varchar(255) DEFAULT NULL COMMENT 'å›¾æ ‡',
    `parent_id` bigint DEFAULT NULL COMMENT 'çˆ¶èŠ‚ç‚¹ID',
    `name_path` varchar(255) DEFAULT NULL,
    `path` varchar(255) DEFAULT NULL,
    `create_time` datetime DEFAULT NULL,
    `update_time` datetime DEFAULT NULL,
    `create_user` varchar(32) DEFAULT NULL,
    `update_user` varchar(32) DEFAULT NULL,
    `deleted` tinyint(1) DEFAULT '0' COMMENT '0:æ­£å¸¸ï¼›1:åˆ é™¤',
    PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç›´æ’­æ ç›®';

CREATE TABLE `livestream_square_config` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `type` enum('HOME_PAGE', 'COLUMN') NOT NULL COMMENT 'ç±»å‹',
  `online_ratio` tinyint unsigned DEFAULT '0' COMMENT 'åœ¨çº¿äººæ•°ç³»æ•°ï¼ˆ0-100ï¼‰',
  `uv_ratio` tinyint unsigned DEFAULT '0' COMMENT 'ç´¯è®¡äººæ•°ç³»æ•°ï¼ˆ0-100ï¼‰',
  `time_ratio` tinyint unsigned DEFAULT '0' COMMENT 'ç›´æ’­æ—¶é•¿ç³»æ•°ï¼ˆ0-100ï¼‰',
  `weight_ratio` tinyint unsigned DEFAULT '0' COMMENT 'å¹³å°æƒé‡ç³»æ•°ï¼ˆ0-1ï¼‰',
  `create_time` datetime DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  `create_user` varchar(32) DEFAULT NULL,
  `update_user` varchar(32) DEFAULT NULL,
  `deleted` tinyint(1) DEFAULT '0' COMMENT '0:æ­£å¸¸ï¼›1:åˆ é™¤',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç›´æ’­å¹¿åœºé…ç½®';

CREATE TABLE `livestream_room_weight_config` (
  `live_room_id` bigint(20) unsigned NOT NULL,
  `weight_ratio` tinyint DEFAULT '0' COMMENT 'ç›´æ’­é—´æƒé‡ç³»æ•°ï¼ˆ0-1ï¼‰',
  `create_time` datetime DEFAULT NULL,
  `update_time` datetime DEFAULT NULL,
  `deleted` tinyint(1) DEFAULT '0' COMMENT '0:æ­£å¸¸ï¼›1:åˆ é™¤',
  PRIMARY KEY (`live_room_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç›´æ’­é—´æƒé‡é…ç½®';
```

## ç²¾é€‰è”ç›Ÿ
1. åˆ†é”€çŠ¶æ€
2. é¢„å‘Šæ¸…å•ï¼ˆåœºæ¬¡åŠ å°±ç»ªçŠ¶æ€ï¼‰
